print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
SSE<-sum_of_square_y-2*beta0*sum_y-2*beta1*sum_xy+n*beta0^2+(beta1^2)*sum_of_square_x
MSE<-SSE/(n-2)
MSR<-n*beta0^2+2*beta0*beta1*sum_x-2*n*beta0*mean_y-2*n*beta1*sum_x*mean_y+n*mean_y^2+(beta1^2)*sum_of_square_x
msr<-beta1^2*(sum_of_square_x-n*mean_x)
print(msr)
print(MSR)
print(paste0("SSE = ",SSE))
print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
SSE<-sum_of_square_y-2*beta0*sum_y-2*beta1*sum_xy+n*beta0^2+(beta1^2)*sum_of_square_x
MSE<-SSE/(n-2)
MSR<-n*beta0^2+2*beta0*beta1*sum_x-2*n*beta0*mean_y-2*n*beta1*sum_x*mean_y+n*mean_y^2+(beta1^2)*sum_of_square_x
msr<-beta1^2*(sum_of_square_x-n*mean_x^2)
print(msr)
print(MSR)
print(paste0("SSE = ",SSE))
print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
SSE<-sum_of_square_y-2*beta0*sum_y-2*beta1*sum_xy+n*beta0^2+(beta1^2)*sum_of_square_x
MSE<-SSE/(n-2)
MSR<-beta1^2*(sum_of_square_x-n*mean_x^2)/1
print(MSR)
print(paste0("SSE = ",SSE))
print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
SSE<-sum_of_square_y-2*beta0*sum_y-2*beta1*sum_xy+n*beta0^2+(beta1^2)*sum_of_square_x
sse<-sum_of_square_y-2*sum_y*beta0-2*beta1*sum_x*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
print(c(SSE,sse))
MSE<-SSE/(n-2)
MSR<-beta1^2*(sum_of_square_x-n*mean_x^2)/1
print(paste0("SSE = ",SSE))
print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
SSE<-sum_of_square_y-2*beta0*sum_y-2*beta1*sum_xy+n*beta0^2+(beta1^2)*sum_of_square_x
sse<-sum_of_square_y-beta0*sum_y-2*beta1*sum_xy-beta0*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
print(c(SSE,sse))
MSE<-SSE/(n-2)
MSR<-beta1^2*(sum_of_square_x-n*mean_x^2)/1
print(paste0("SSE = ",SSE))
print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
SSE<-sum_of_square_y-beta0*sum_y-2*beta1*sum_xy-beta0*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
MSE<-SSE/(n-2)
MSR<-beta1^2*(sum_of_square_x-n*mean_x^2)/1
print(paste0("SSE = ",SSE))
print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
knitr::opts_chunk$set(echo = TRUE)
sum_x<-6602
mean_x<-6602/84
sum_y<-597341
mean_y<-597341/84
sum_of_square_x<-522098
sum_of_square_y<-4796548849
sum_xy<-46400230
n<-84
Sxx<-sum_of_square_x-n*(mean_x^2)
beta1<-(sum_xy-n*mean_y*mean_x)/(sum_of_square_x-n*(mean_x)^2)
beta0<-mean_y-beta1*mean_x
print(paste0("Yi_hat = ",beta1," Xi + ",beta0))
sum_x<-6602
mean_x<-6602/84
sum_y<-597341
mean_y<-597341/84
sum_of_square_x<-522098
sum_of_square_y<-4796548849
sum_xy<-46400230
n<-84
Sxx<-sum_of_square_x-n*(mean_x^2)
beta1<-(sum_xy-n*mean_y*mean_x)/(sum_of_square_x-n*(mean_x)^2)
beta0<-mean_y-beta1*mean_x
print(paste0("Yi_hat = ",beta1," Xi + ",beta0))
SSE<-sum_of_square_y-beta0*sum_y-2*beta1*sum_xy-beta0*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
MSE<-SSE/(n-2)
MSR<-beta1^2*(sum_of_square_x-n*mean_x^2)/1
print(paste0("SSE = ",SSE))
print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
se_beta0<-(MSE*(1/86+(mean_x^2/Sxx)))^0.5
se_beta1<-(MSE/Sxx)^0.5
print(paste0("standard errors of β0 hat = ",se_beta0))
print(paste0("standard errors of β1 hat = ",se_beta1))
# h0: Beta1 = 0 v.s. h1: Beta1 not equal 0
# E(beta1)=Beta1
# T-test T*= (beta1-0)/s.e{beata1}
# if T*>t(0.99,82) then reject h0; otherwise, accept h0.
pivotal_quantity<-beta1/se_beta1
if (abs(pivotal_quantity)>qt(0.09,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
#unbiased estimator for β0 is  β0 hat.
lower_bound<-beta0-qt(0.995,82)*se_beta0
upper_bound<-beta0+qt(0.995,82)*se_beta0
print(paste0("C.I of β0 = [",lower_bound,",",upper_bound,"]"))
y_h<-beta0+beta1*85
se_yh<-(MSE*(1/n+(85-mean_x)^2/Sxx))^0.5
ci_E_yh_upperbound<-y_h+se_yh*qt(0.975,82)
ci_E_yh_lowerbound<-y_h-se_yh*qt(0.975,82)
print(paste0("C.I of mean crime rate = [",ci_E_yh_lowerbound,",",ci_E_yh_upperbound,"]"))
y_h_new<-beta0+beta1*85
se_yh_new<-(MSE*(1+1/n+(85-mean_x)^2/Sxx))^0.5
ci_E_yh_new_upperbound<-(y_h_new)+se_yh_new*qt(0.975,82)
ci_E_yh_new_lowerbound<-(y_h_new)-se_yh_new*qt(0.975,82)
print(paste0("prediction interval for the crime rate = [",ci_E_yh_new_lowerbound,",",ci_E_yh_new_upperbound,"]"))
SSE<-sum_of_square_y-2*beta0*sum_y-2*beta1*sum_xy+n*beta0^2+(beta1^2)*sum_of_square_x
SSR<-n*beta0^2+2*beta0*beta1*sum_x-2*n*beta0*mean_y-2*n*beta1*sum_x*mean_y+n*mean_y^2+(beta1^2)*sum_of_square_x
SSTO<-SSE+SSR
print(paste0("SSR = ",SSR," degrees of freedom = ",1))
print(paste0("SSE = ",SSE," degrees of freedom = ",82))
print(paste0("SSTO = ",SSTO," degrees of freedom = ",83))
SSE<-sum_of_square_y-beta0*sum_y-2*beta1*sum_xy-beta0*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
SSR<-beta1^2*(sum_of_square_x-n*mean_x^2)
SSTO<-SSE+SSR
print(paste0("SSR = ",SSR," degrees of freedom = ",1))
print(paste0("SSE = ",SSE," degrees of freedom = ",82))
print(paste0("SSTO = ",SSTO," degrees of freedom = ",83))
MSE<-SSE/82
MSR<-SSR/1
print(paste0("MSE = ",MSE))
print(paste0("MSR = ",MSR))
MSE<-SSE/82
MSR<-SSR/1
print(paste0("MSE = ",MSE))
print(paste0("MSR = ",MSR))
print(MSR/MSE)
# h0: beta1 hat = 0 v.s. h1: beta1 hat not equal 0
# F-test F*= (SSR/1)/(SSE/82)
# if F*>F(0.99,1,82) then reject h0; otherwise, accept h0.
pivotal_quantity<-MSR/MSE
print(paste0("pivotal_quantity-F* = ",pivotal_quantity))
if (ftest>qf(0.09,1,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
# h0: beta1 hat = 0 v.s. h1: beta1 hat not equal 0
# F-test F*= (SSR/1)/(SSE/82)
# if F*>F(0.99,1,82) then reject h0; otherwise, accept h0.
f-pivotal_quantity<-MSR/MSE
# h0: beta1 hat = 0 v.s. h1: beta1 hat not equal 0
# F-test F*= (SSR/1)/(SSE/82)
# if F*>F(0.99,1,82) then reject h0; otherwise, accept h0.
f_pivotal_quantity<-MSR/MSE
print(paste0("pivotal_quantity-F* = ",f_pivotal_quantity))
if (ftest>qf(0.09,1,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
# h0: Beta1 = 0 v.s. h1: Beta1 not equal 0
# E(beta1)=Beta1
# T-test T*= (beta1-0)/s.e{beata1}
# if T*>t(0.99,82) then reject h0; otherwise, accept h0.
t_pivotal_quantity<-beta1/se_beta1
print(paste0("pivotal_quantity = ",t_pivotal_quantity))
if (abs(pivotal_quantity)>qt(0.09,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
# h0: Beta1 = 0 v.s. h1: Beta1 not equal 0
# E(beta1)=Beta1
# T-test T*= (beta1-0)/s.e{beata1}
# if T*>t(0.99,82) then reject h0; otherwise, accept h0.
t_pivotal_quantity<-beta1/se_beta1
print(paste0("pivotal_quantity = ",abs(t_pivotal_quantity)))
if (abs(pivotal_quantity)>qt(0.09,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
if (t_pivotal_quantity^2==f_pivotal_quantity){
print(TRUE)
}
if (t_pivotal_quantity^2==f_pivotal_quantity){
print("(T*)^2=F*")
}
if (t_pivotal_quantity^2==f_pivotal_quantity){
print(" (T*)^2=F* ")
}
r_square<-SSR/SSTO
print(paste0("r_square = ",r_square))
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
if(r_xy^2==r_square){
print("R square is twice as much as correlation coefficient r  ")
}
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
if(r_xy^2==r_square){
print("R square is twice as much as correlation coefficient r  ")
}
r_square<-SSR/SSTO
print(paste0("r_square = ",r_square))
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
if(r_xy^2==r_square){
print("R square is twice as much as correlation coefficient r ")
}
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
print(r_xy)
if(r_xy^2==r_square){
print("R square is twice as much as correlation coefficient r ")
}
knitr::opts_chunk$set(echo = TRUE)
sum_x<-6602
mean_x<-6602/84
sum_y<-597341
mean_y<-597341/84
sum_of_square_x<-522098
sum_of_square_y<-4796548849
sum_xy<-46400230
n<-84
Sxx<-sum_of_square_x-n*(mean_x^2)
beta1<-(sum_xy-n*mean_y*mean_x)/(sum_of_square_x-n*(mean_x)^2)
beta0<-mean_y-beta1*mean_x
print(paste0("Yi_hat = ",beta1," Xi + ",beta0))
SSE<-sum_of_square_y-beta0*sum_y-2*beta1*sum_xy-beta0*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
MSE<-SSE/(n-2)
MSR<-beta1^2*(sum_of_square_x-n*mean_x^2)/1
print(paste0("SSE = ",SSE))
print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
se_beta0<-(MSE*(1/86+(mean_x^2/Sxx)))^0.5
se_beta1<-(MSE/Sxx)^0.5
print(paste0("standard errors of β0 hat = ",se_beta0))
print(paste0("standard errors of β1 hat = ",se_beta1))
# h0: Beta1 = 0 v.s. h1: Beta1 not equal 0
# E(beta1)=Beta1
# T-test T*= (beta1-0)/s.e{beata1}
# if T*>t(0.99,82) then reject h0; otherwise, accept h0.
t_pivotal_quantity<-beta1/se_beta1
print(paste0("pivotal_quantity = ",abs(t_pivotal_quantity)))
if (abs(pivotal_quantity)>qt(0.09,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
#unbiased estimator for β0 is  β0 hat.
lower_bound<-beta0-qt(0.995,82)*se_beta0
upper_bound<-beta0+qt(0.995,82)*se_beta0
print(paste0("C.I of β0 = [",lower_bound,",",upper_bound,"]"))
y_h<-beta0+beta1*85
se_yh<-(MSE*(1/n+(85-mean_x)^2/Sxx))^0.5
ci_E_yh_upperbound<-y_h+se_yh*qt(0.975,82)
ci_E_yh_lowerbound<-y_h-se_yh*qt(0.975,82)
print(paste0("C.I of mean crime rate = [",ci_E_yh_lowerbound,",",ci_E_yh_upperbound,"]"))
y_h_new<-beta0+beta1*85
se_yh_new<-(MSE*(1+1/n+(85-mean_x)^2/Sxx))^0.5
ci_E_yh_new_upperbound<-(y_h_new)+se_yh_new*qt(0.975,82)
ci_E_yh_new_lowerbound<-(y_h_new)-se_yh_new*qt(0.975,82)
print(paste0("prediction interval for the crime rate = [",ci_E_yh_new_lowerbound,",",ci_E_yh_new_upperbound,"]"))
SSE<-sum_of_square_y-beta0*sum_y-2*beta1*sum_xy-beta0*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
SSR<-beta1^2*(sum_of_square_x-n*mean_x^2)
SSTO<-SSE+SSR
print(paste0("SSR = ",SSR," degrees of freedom = ",1))
print(paste0("SSE = ",SSE," degrees of freedom = ",82))
print(paste0("SSTO = ",SSTO," degrees of freedom = ",83))
MSE<-SSE/82
MSR<-SSR/1
print(paste0("MSE = ",MSE))
print(paste0("MSR = ",MSR))
# h0: beta1 hat = 0 v.s. h1: beta1 hat not equal 0
# F-test F*= (SSR/1)/(SSE/82)
# if F*>F(0.99,1,82) then reject h0; otherwise, accept h0.
f_pivotal_quantity<-MSR/MSE
print(paste0("pivotal_quantity-F* = ",f_pivotal_quantity))
if (ftest>qf(0.09,1,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
if (t_pivotal_quantity^2==f_pivotal_quantity){
print(" (T*)^2=F* ")
}
r_square<-SSR/SSTO
print(paste0("r_square = ",r_square))
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
print(r_xy)
if(r_xy^2==r_square){
print("R square is twice as much as correlation coefficient r ")
}
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
print(r_xy^2)
if(r_xy^2==r_square){
print("R square is twice as much as correlation coefficient r ")
}
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
print(r_xy^2)
if(r_xy^2==r_square){
print("R square is twice as much as correlation coefficient r ")
}
(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
test<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))
print(r_xy^2)
if(abs(test)==r_square){
print("R square is twice as much as correlation coefficient r ")
}
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
print(r_xy^2)
if(abs(test)==round(r_square,6)){
print("R square is twice as much as correlation coefficient r ")
}
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
if(abs(test)==round(r_square,5)){
print("R square is twice as much as correlation coefficient r ")
}
round(r_square,6)
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
if(round(r_xy,6)==round(r_square,6)){
print("R square is twice as much as correlation coefficient r ")
}
round(r_xy,6)
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
if(round(r_xy^2,6)==round(r_square,6)){
print("R square is twice as much as correlation coefficient r ")
}
MSE<-SSE/82
MSR<-SSR/1
print(paste0("MSE = ",MSE))
print(paste0("MSR = ",MSR))
# h0: Beta1 = 0 v.s. h1: Beta1 not equal 0
# E(beta1)=Beta1
# T-test T*= (beta1-0)/s.e{beata1}
# if T*>t(0.99,82) then reject h0; otherwise, accept h0.
t_pivotal_quantity<-beta1/se_beta1
print(paste0("pivotal_quantity = ",abs(t_pivotal_quantity)))
if (abs(pivotal_quantity)>qt(0.09,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
se_beta0<-(MSE*(1/86+(mean_x^2/Sxx)))^0.5
se_beta1<-(MSE/Sxx)^0.5
print(paste0("standard errors of β0 hat = ",se_beta0))
print(paste0("standard errors of β1 hat = ",se_beta1))
SSE<-sum_of_square_y-beta0*sum_y-2*beta1*sum_xy-beta0*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
MSE<-SSE/(n-2)
MSR<-beta1^2*(sum_of_square_x-n*mean_x^2)/1
print(paste0("SSE = ",SSE))
print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
knitr::opts_chunk$set(echo = TRUE)
sum_x<-6602
mean_x<-6602/84
sum_y<-597341
mean_y<-597341/84
sum_of_square_x<-522098
sum_of_square_y<-4796548849
sum_xy<-46400230
n<-84
Sxx<-sum_of_square_x-n*(mean_x^2)
beta1<-(sum_xy-n*mean_y*mean_x)/(sum_of_square_x-n*(mean_x)^2)
beta0<-mean_y-beta1*mean_x
print(paste0("Yi_hat = ",beta1," Xi + ",beta0))
SSE<-sum_of_square_y-beta0*sum_y-2*beta1*sum_xy-beta0*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
MSE<-SSE/(n-2)
MSR<-beta1^2*(sum_of_square_x-n*mean_x^2)/1
print(paste0("SSE = ",SSE))
print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
# h0: Beta1 = 0 v.s. h1: Beta1 not equal 0
# E(beta1)=Beta1
# T-test T*= (beta1-0)/s.e{beata1}
# if T*>t(0.99,82) then reject h0; otherwise, accept h0.
t_pivotal_quantity<-beta1/se_beta1
print(paste0("pivotal_quantity = ",abs(t_pivotal_quantity)))
if (abs(pivotal_quantity)>qt(0.09,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
#unbiased estimator for β0 is  β0 hat.
lower_bound<-beta0-qt(0.995,82)*se_beta0
upper_bound<-beta0+qt(0.995,82)*se_beta0
print(paste0("C.I of β0 = [",lower_bound,",",upper_bound,"]"))
y_h<-beta0+beta1*85
se_yh<-(MSE*(1/n+(85-mean_x)^2/Sxx))^0.5
ci_E_yh_upperbound<-y_h+se_yh*qt(0.975,82)
ci_E_yh_lowerbound<-y_h-se_yh*qt(0.975,82)
print(paste0("C.I of mean crime rate = [",ci_E_yh_lowerbound,",",ci_E_yh_upperbound,"]"))
y_h_new<-beta0+beta1*85
se_yh_new<-(MSE*(1+1/n+(85-mean_x)^2/Sxx))^0.5
ci_E_yh_new_upperbound<-(y_h_new)+se_yh_new*qt(0.975,82)
ci_E_yh_new_lowerbound<-(y_h_new)-se_yh_new*qt(0.975,82)
print(paste0("prediction interval for the crime rate = [",ci_E_yh_new_lowerbound,",",ci_E_yh_new_upperbound,"]"))
SSE<-sum_of_square_y-beta0*sum_y-2*beta1*sum_xy-beta0*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
SSR<-beta1^2*(sum_of_square_x-n*mean_x^2)
SSTO<-SSE+SSR
print(paste0("SSR = ",SSR," degrees of freedom = ",1))
print(paste0("SSE = ",SSE," degrees of freedom = ",82))
print(paste0("SSTO = ",SSTO," degrees of freedom = ",83))
MSE<-SSE/82
MSR<-SSR/1
print(paste0("MSE = ",MSE))
print(paste0("MSR = ",MSR))
# h0: beta1 hat = 0 v.s. h1: beta1 hat not equal 0
# F-test F*= (SSR/1)/(SSE/82)
# if F*>F(0.99,1,82) then reject h0; otherwise, accept h0.
f_pivotal_quantity<-MSR/MSE
print(paste0("pivotal_quantity-F* = ",f_pivotal_quantity))
if (ftest>qf(0.09,1,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
if (t_pivotal_quantity^2==f_pivotal_quantity){
print(" (T*)^2=F* ")
}
r_square<-SSR/SSTO
print(paste0("r_square = ",r_square))
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
if(round(r_xy^2,6)==round(r_square,6)){
print("R square is twice as much as correlation coefficient r ")
}
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
knitr::opts_chunk$set(echo = TRUE)
sum_x<-6602
mean_x<-6602/84
sum_y<-597341
mean_y<-597341/84
sum_of_square_x<-522098
sum_of_square_y<-4796548849
sum_xy<-46400230
n<-84
Sxx<-sum_of_square_x-n*(mean_x^2)
beta1<-(sum_xy-n*mean_y*mean_x)/(sum_of_square_x-n*(mean_x)^2)
beta0<-mean_y-beta1*mean_x
print(paste0("Yi_hat = ",beta1," Xi + ",beta0))
SSE<-sum_of_square_y-beta0*sum_y-2*beta1*sum_xy-beta0*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
MSE<-SSE/(n-2)
MSR<-beta1^2*(sum_of_square_x-n*mean_x^2)/1
print(paste0("SSE = ",SSE))
print(paste0("MSE = ",MSE))
print(paste0("degrees of freedom of SSE = ",n-2))
se_beta0<-(MSE*(1/86+(mean_x^2/Sxx)))^0.5
se_beta1<-(MSE/Sxx)^0.5
print(paste0("standard errors of β0 hat = ",se_beta0))
print(paste0("standard errors of β1 hat = ",se_beta1))
se_beta0<-(MSE*(1/86+(mean_x^2/Sxx)))^0.5
se_beta1<-(MSE/Sxx)^0.5
print(paste0("standard errors of β0 hat = ",se_beta0))
print(paste0("standard errors of β1 hat = ",se_beta1))
# h0: Beta1 = 0 v.s. h1: Beta1 not equal 0
# E(beta1)=Beta1
# T-test T*= (beta1-0)/s.e{beata1}
# if T*>t(0.99,82) then reject h0; otherwise, accept h0.
t_pivotal_quantity<-beta1/se_beta1
print(paste0("pivotal_quantity = ",abs(t_pivotal_quantity)))
if (abs(pivotal_quantity)>qt(0.09,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
# h0: Beta1 = 0 v.s. h1: Beta1 not equal 0
# E(beta1)=Beta1
# T-test T*= (beta1-0)/s.e{beata1}
# if T*>t(0.99,82) then reject h0; otherwise, accept h0.
t_pivotal_quantity<-beta1/se_beta1
print(paste0("pivotal_quantity = ",abs(t_pivotal_quantity)))
if (abs(t_pivotal_quantity)>qt(0.09,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
#unbiased estimator for β0 is  β0 hat.
lower_bound<-beta0-qt(0.995,82)*se_beta0
upper_bound<-beta0+qt(0.995,82)*se_beta0
print(paste0("C.I of β0 = [",lower_bound,",",upper_bound,"]"))
y_h<-beta0+beta1*85
se_yh<-(MSE*(1/n+(85-mean_x)^2/Sxx))^0.5
ci_E_yh_upperbound<-y_h+se_yh*qt(0.975,82)
ci_E_yh_lowerbound<-y_h-se_yh*qt(0.975,82)
print(paste0("C.I of mean crime rate = [",ci_E_yh_lowerbound,",",ci_E_yh_upperbound,"]"))
y_h_new<-beta0+beta1*85
se_yh_new<-(MSE*(1+1/n+(85-mean_x)^2/Sxx))^0.5
ci_E_yh_new_upperbound<-(y_h_new)+se_yh_new*qt(0.975,82)
ci_E_yh_new_lowerbound<-(y_h_new)-se_yh_new*qt(0.975,82)
print(paste0("prediction interval for the crime rate = [",ci_E_yh_new_lowerbound,",",ci_E_yh_new_upperbound,"]"))
SSE<-sum_of_square_y-beta0*sum_y-2*beta1*sum_xy-beta0*sum_y+n*beta0^2+2*beta0*beta1*sum_x+(beta1^2)*sum_of_square_x
SSR<-beta1^2*(sum_of_square_x-n*mean_x^2)
SSTO<-SSE+SSR
print(paste0("SSR = ",SSR," degrees of freedom = ",1))
print(paste0("SSE = ",SSE," degrees of freedom = ",82))
print(paste0("SSTO = ",SSTO," degrees of freedom = ",83))
MSE<-SSE/82
MSR<-SSR/1
print(paste0("MSE = ",MSE))
print(paste0("MSR = ",MSR))
# h0: beta1 hat = 0 v.s. h1: beta1 hat not equal 0
# F-test F*= (SSR/1)/(SSE/82)
# if F*>F(0.99,1,82) then reject h0; otherwise, accept h0.
f_pivotal_quantity<-MSR/MSE
print(paste0("pivotal_quantity-F* = ",f_pivotal_quantity))
if (f_pivotal_quantity>qf(0.09,1,82)){
print("reject h0, there is a linear association between crime rate and percentage of high school graduates at significance level 0.01. ")
}else{
print("b1 is equal 0, there isn't a linear association between crime rate and percentage of high school graduates at significance level 0.01.")
}
if (t_pivotal_quantity^2==f_pivotal_quantity){
print(" (T*)^2=F* ")
}
r_square<-SSR/SSTO
print(paste0("r_square = ",r_square))
r_xy<-(sum_xy-n*mean_x*mean_y)/((sum_of_square_x-n*mean_x^2)*(sum_of_square_y-n*mean_y^2))^0.5
if(round(r_xy^2,6)==round(r_square,6)){
print("R square is twice as much as correlation coefficient r ")
}
setwd("~/Documents/GitHub/141A-final-project")
data<-read.csv("data_ML.csv")
